{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "1c4dad70",
   "metadata": {},
   "source": [
    "# Text Preprocessing in NLP\n",
    "Tokenize Text Columns Into Sentences"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f89f099b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Required libraries\n",
    "\n",
    "# [pip install spacy](https://pypi.org/project/spacy/)\n",
    "\n",
    "# # Input the following into gitbash: \"python -m spacy download en_core_web_sm\"\n",
    "# !pip install spacy\n",
    "# !python -m spacy download en_core_web_sm\n",
    "# !conda install -c anaconda nltk\n",
    "# !pip install -U nltk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "a0eb126d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import Dependencies and setup\n",
    "import pandas as pd\n",
    "import spacy\n",
    "import nltk\n",
    "import os"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a085e980",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ï»¿</th>\n",
       "      <th>author</th>\n",
       "      <th>total_followers</th>\n",
       "      <th>total_following</th>\n",
       "      <th>number_posts</th>\n",
       "      <th>shortcode</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>Date</th>\n",
       "      <th>time</th>\n",
       "      <th>likes</th>\n",
       "      <th>...</th>\n",
       "      <th>Tag_2</th>\n",
       "      <th>Tag_3</th>\n",
       "      <th>Tag_4</th>\n",
       "      <th>Tag_5</th>\n",
       "      <th>Tag_6</th>\n",
       "      <th>Tag_7</th>\n",
       "      <th>Tag_8</th>\n",
       "      <th>Tag_9</th>\n",
       "      <th>Tag_10</th>\n",
       "      <th>Tag_11</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSzoxcyrzj2</td>\n",
       "      <td>1629485286</td>\n",
       "      <td>44428.78340</td>\n",
       "      <td>44428.78340</td>\n",
       "      <td>19080</td>\n",
       "      <td>...</td>\n",
       "      <td>SF90</td>\n",
       "      <td>futureshmeemobile</td>\n",
       "      <td>AssettoFiorano</td>\n",
       "      <td>BannedAuto</td>\n",
       "      <td>LAcars</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSr2jQPjy59</td>\n",
       "      <td>1629224075</td>\n",
       "      <td>44425.76013</td>\n",
       "      <td>44425.76013</td>\n",
       "      <td>22143</td>\n",
       "      <td>...</td>\n",
       "      <td>P1</td>\n",
       "      <td>McLarenP1</td>\n",
       "      <td>testdrive</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSpWzdxJIIV</td>\n",
       "      <td>1629140321</td>\n",
       "      <td>44424.79075</td>\n",
       "      <td>44424.79075</td>\n",
       "      <td>21606</td>\n",
       "      <td>...</td>\n",
       "      <td>300SL</td>\n",
       "      <td>PebbleBeach</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>testdrive</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSkdxyJAk2n</td>\n",
       "      <td>1628976206</td>\n",
       "      <td>44422.89127</td>\n",
       "      <td>44422.89127</td>\n",
       "      <td>30069</td>\n",
       "      <td>...</td>\n",
       "      <td>Bolide</td>\n",
       "      <td>Quail</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSfHSEzi3BD</td>\n",
       "      <td>1628796639</td>\n",
       "      <td>44420.81295</td>\n",
       "      <td>44420.81295</td>\n",
       "      <td>34073</td>\n",
       "      <td>...</td>\n",
       "      <td>Valkyrie</td>\n",
       "      <td>ValkyrieSpider</td>\n",
       "      <td>firstlook</td>\n",
       "      <td>PebbleBeach</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   ï»¿    author  total_followers  total_following  number_posts    shortcode  \\\n",
       "0    0  shmee150          1581500             2857         10552  CSzoxcyrzj2   \n",
       "1    1  shmee150          1581500             2857         10552  CSr2jQPjy59   \n",
       "2    2  shmee150          1581500             2857         10552  CSpWzdxJIIV   \n",
       "3    3  shmee150          1581500             2857         10552  CSkdxyJAk2n   \n",
       "4    4  shmee150          1581500             2857         10552  CSfHSEzi3BD   \n",
       "\n",
       "    timestamp         Date         time  likes  ...      Tag_2  \\\n",
       "0  1629485286  44428.78340  44428.78340  19080  ...      SF90    \n",
       "1  1629224075  44425.76013  44425.76013  22143  ...        P1    \n",
       "2  1629140321  44424.79075  44424.79075  21606  ...     300SL    \n",
       "3  1628976206  44422.89127  44422.89127  30069  ...    Bolide    \n",
       "4  1628796639  44420.81295  44420.81295  34073  ...  Valkyrie    \n",
       "\n",
       "                Tag_3            Tag_4         Tag_5     Tag_6     Tag_7  \\\n",
       "0  futureshmeemobile   AssettoFiorano    BannedAuto    LAcars   Shmee150   \n",
       "1          McLarenP1        testdrive       CarWeek   Shmee150       NaN   \n",
       "2        PebbleBeach          CarWeek     testdrive   Shmee150       NaN   \n",
       "3              Quail          CarWeek       Shmee150       NaN       NaN   \n",
       "4     ValkyrieSpider        firstlook   PebbleBeach   CarWeek   Shmee150   \n",
       "\n",
       "  Tag_8 Tag_9 Tag_10 Tag_11  \n",
       "0   NaN   NaN    NaN    NaN  \n",
       "1   NaN   NaN    NaN    NaN  \n",
       "2   NaN   NaN    NaN    NaN  \n",
       "3   NaN   NaN    NaN    NaN  \n",
       "4   NaN   NaN    NaN    NaN  \n",
       "\n",
       "[5 rows x 26 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# read csv output from Instagrapy_split_text.ipynb\n",
    "df=pd.read_csv(\"../../resources/Wordcloud_Data_Set_MBJ.csv\", encoding=\"ISO 8859-1\")\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "statewide-divide",
   "metadata": {},
   "source": [
    "### Sentiment Analyzer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "downtown-somewhere",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.reset_index(inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "patent-remark",
   "metadata": {},
   "outputs": [],
   "source": [
    "ig_posts = df['text']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "accessible-marina",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>ï»¿</th>\n",
       "      <th>author</th>\n",
       "      <th>total_followers</th>\n",
       "      <th>total_following</th>\n",
       "      <th>number_posts</th>\n",
       "      <th>shortcode</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>Date</th>\n",
       "      <th>time</th>\n",
       "      <th>...</th>\n",
       "      <th>Tag_2</th>\n",
       "      <th>Tag_3</th>\n",
       "      <th>Tag_4</th>\n",
       "      <th>Tag_5</th>\n",
       "      <th>Tag_6</th>\n",
       "      <th>Tag_7</th>\n",
       "      <th>Tag_8</th>\n",
       "      <th>Tag_9</th>\n",
       "      <th>Tag_10</th>\n",
       "      <th>Tag_11</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSzoxcyrzj2</td>\n",
       "      <td>1629485286</td>\n",
       "      <td>44428.78340</td>\n",
       "      <td>44428.78340</td>\n",
       "      <td>...</td>\n",
       "      <td>SF90</td>\n",
       "      <td>futureshmeemobile</td>\n",
       "      <td>AssettoFiorano</td>\n",
       "      <td>BannedAuto</td>\n",
       "      <td>LAcars</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSr2jQPjy59</td>\n",
       "      <td>1629224075</td>\n",
       "      <td>44425.76013</td>\n",
       "      <td>44425.76013</td>\n",
       "      <td>...</td>\n",
       "      <td>P1</td>\n",
       "      <td>McLarenP1</td>\n",
       "      <td>testdrive</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSpWzdxJIIV</td>\n",
       "      <td>1629140321</td>\n",
       "      <td>44424.79075</td>\n",
       "      <td>44424.79075</td>\n",
       "      <td>...</td>\n",
       "      <td>300SL</td>\n",
       "      <td>PebbleBeach</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>testdrive</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSkdxyJAk2n</td>\n",
       "      <td>1628976206</td>\n",
       "      <td>44422.89127</td>\n",
       "      <td>44422.89127</td>\n",
       "      <td>...</td>\n",
       "      <td>Bolide</td>\n",
       "      <td>Quail</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSfHSEzi3BD</td>\n",
       "      <td>1628796639</td>\n",
       "      <td>44420.81295</td>\n",
       "      <td>44420.81295</td>\n",
       "      <td>...</td>\n",
       "      <td>Valkyrie</td>\n",
       "      <td>ValkyrieSpider</td>\n",
       "      <td>firstlook</td>\n",
       "      <td>PebbleBeach</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>343</th>\n",
       "      <td>343</td>\n",
       "      <td>343</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSZ8acRJ4jt</td>\n",
       "      <td>1628623169</td>\n",
       "      <td>44418.80520</td>\n",
       "      <td>44418.80520</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>344</th>\n",
       "      <td>344</td>\n",
       "      <td>344</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSZZfp2Hs0r</td>\n",
       "      <td>1628604861</td>\n",
       "      <td>44418.59330</td>\n",
       "      <td>44418.59330</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>345</th>\n",
       "      <td>345</td>\n",
       "      <td>345</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSYTSCEgCC7</td>\n",
       "      <td>1628568165</td>\n",
       "      <td>44418.16858</td>\n",
       "      <td>44418.16858</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>346</th>\n",
       "      <td>346</td>\n",
       "      <td>346</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSW4jvynJ3N</td>\n",
       "      <td>1628520524</td>\n",
       "      <td>44417.61718</td>\n",
       "      <td>44417.61718</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>347</th>\n",
       "      <td>347</td>\n",
       "      <td>347</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSWB2CUrFo2</td>\n",
       "      <td>1628491798</td>\n",
       "      <td>44417.28470</td>\n",
       "      <td>44417.28470</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>348 rows × 27 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     index  ï»¿       author  total_followers  total_following  number_posts  \\\n",
       "0        0    0     shmee150          1581500             2857         10552   \n",
       "1        1    1     shmee150          1581500             2857         10552   \n",
       "2        2    2     shmee150          1581500             2857         10552   \n",
       "3        3    3     shmee150          1581500             2857         10552   \n",
       "4        4    4     shmee150          1581500             2857         10552   \n",
       "..     ...  ...          ...              ...              ...           ...   \n",
       "343    343  343  simeonpanda          7872317              187          7465   \n",
       "344    344  344  simeonpanda          7872317              187          7465   \n",
       "345    345  345  simeonpanda          7872317              187          7465   \n",
       "346    346  346  simeonpanda          7872317              187          7465   \n",
       "347    347  347  simeonpanda          7872317              187          7465   \n",
       "\n",
       "       shortcode   timestamp         Date         time  ...      Tag_2  \\\n",
       "0    CSzoxcyrzj2  1629485286  44428.78340  44428.78340  ...      SF90    \n",
       "1    CSr2jQPjy59  1629224075  44425.76013  44425.76013  ...        P1    \n",
       "2    CSpWzdxJIIV  1629140321  44424.79075  44424.79075  ...     300SL    \n",
       "3    CSkdxyJAk2n  1628976206  44422.89127  44422.89127  ...    Bolide    \n",
       "4    CSfHSEzi3BD  1628796639  44420.81295  44420.81295  ...  Valkyrie    \n",
       "..           ...         ...          ...          ...  ...        ...   \n",
       "343  CSZ8acRJ4jt  1628623169  44418.80520  44418.80520  ...        NaN   \n",
       "344  CSZZfp2Hs0r  1628604861  44418.59330  44418.59330  ...        NaN   \n",
       "345  CSYTSCEgCC7  1628568165  44418.16858  44418.16858  ...        NaN   \n",
       "346  CSW4jvynJ3N  1628520524  44417.61718  44417.61718  ...        NaN   \n",
       "347  CSWB2CUrFo2  1628491798  44417.28470  44417.28470  ...        NaN   \n",
       "\n",
       "                  Tag_3            Tag_4         Tag_5     Tag_6     Tag_7  \\\n",
       "0    futureshmeemobile   AssettoFiorano    BannedAuto    LAcars   Shmee150   \n",
       "1            McLarenP1        testdrive       CarWeek   Shmee150       NaN   \n",
       "2          PebbleBeach          CarWeek     testdrive   Shmee150       NaN   \n",
       "3                Quail          CarWeek       Shmee150       NaN       NaN   \n",
       "4       ValkyrieSpider        firstlook   PebbleBeach   CarWeek   Shmee150   \n",
       "..                  ...              ...           ...       ...       ...   \n",
       "343                 NaN              NaN           NaN       NaN       NaN   \n",
       "344                 NaN              NaN           NaN       NaN       NaN   \n",
       "345                 NaN              NaN           NaN       NaN       NaN   \n",
       "346                 NaN              NaN           NaN       NaN       NaN   \n",
       "347                 NaN              NaN           NaN       NaN       NaN   \n",
       "\n",
       "    Tag_8 Tag_9 Tag_10 Tag_11  \n",
       "0     NaN   NaN    NaN    NaN  \n",
       "1     NaN   NaN    NaN    NaN  \n",
       "2     NaN   NaN    NaN    NaN  \n",
       "3     NaN   NaN    NaN    NaN  \n",
       "4     NaN   NaN    NaN    NaN  \n",
       "..    ...   ...    ...    ...  \n",
       "343   NaN   NaN    NaN    NaN  \n",
       "344   NaN   NaN    NaN    NaN  \n",
       "345   NaN   NaN    NaN    NaN  \n",
       "346   NaN   NaN    NaN    NaN  \n",
       "347   NaN   NaN    NaN    NaN  \n",
       "\n",
       "[348 rows x 27 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "demographic-beverage",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'The beautiful 300SL Roadster is without a shadow of a doubt my dream classic car Driving this particular example thats for sale with mbclassiccenter thanks to mercedesbenzmuseum while car spotting countless hypercars around Pebble Beach could not be better Maybe one day for theshmeemobiles maybe one day Mercedes 300SL PebbleBeach CarWeek testdrive Shmee150'"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ig_posts.values[2]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "modified-exception",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[nltk_data] Downloading package vader_lexicon to\n",
      "[nltk_data]     C:\\Users\\17076\\AppData\\Roaming\\nltk_data...\n",
      "[nltk_data]   Package vader_lexicon is already up-to-date!\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import nltk\n",
    "nltk.download('vader_lexicon')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "growing-waterproof",
   "metadata": {},
   "outputs": [],
   "source": [
    "from nltk.sentiment import SentimentIntensityAnalyzer\n",
    "sia = SentimentIntensityAnalyzer()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "adjacent-capture",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'neg': 0.0, 'neu': 0.572, 'pos': 0.428, 'compound': 0.6696}"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sia.polarity_scores('Dartanion is the greatest in the world!')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "nearby-newcastle",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Error with record 17. Moving on...\n",
      "Error with record 64. Moving on...\n",
      "Error with record 82. Moving on...\n",
      "Error with record 88. Moving on...\n",
      "Error with record 93. Moving on...\n",
      "Error with record 122. Moving on...\n",
      "Error with record 128. Moving on...\n",
      "Error with record 149. Moving on...\n",
      "Error with record 150. Moving on...\n",
      "Error with record 222. Moving on...\n"
     ]
    }
   ],
   "source": [
    "df['neg'] = None\n",
    "df['neu'] = None\n",
    "df['pos'] = None\n",
    "df['compound'] = None\n",
    "\n",
    "for k, v in df.iterrows():\n",
    "    post = v['text']\n",
    "    \n",
    "    try:\n",
    "        pol_scores = sia.polarity_scores(post)\n",
    "    except:\n",
    "        print(f'Error with record {k}. Moving on...')\n",
    "    \n",
    "    df.loc[k,'neg'] = pol_scores['neg']\n",
    "    df.loc[k,'neu'] = pol_scores['neu']\n",
    "    df.loc[k,'pos'] = pol_scores['pos']\n",
    "    df.loc[k,'compound'] = pol_scores['compound']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "alert-learning",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>ï»¿</th>\n",
       "      <th>author</th>\n",
       "      <th>total_followers</th>\n",
       "      <th>total_following</th>\n",
       "      <th>number_posts</th>\n",
       "      <th>shortcode</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>Date</th>\n",
       "      <th>time</th>\n",
       "      <th>...</th>\n",
       "      <th>Tag_6</th>\n",
       "      <th>Tag_7</th>\n",
       "      <th>Tag_8</th>\n",
       "      <th>Tag_9</th>\n",
       "      <th>Tag_10</th>\n",
       "      <th>Tag_11</th>\n",
       "      <th>neg</th>\n",
       "      <th>neu</th>\n",
       "      <th>pos</th>\n",
       "      <th>compound</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSzoxcyrzj2</td>\n",
       "      <td>1629485286</td>\n",
       "      <td>44428.78340</td>\n",
       "      <td>44428.78340</td>\n",
       "      <td>...</td>\n",
       "      <td>LAcars</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.054</td>\n",
       "      <td>0.782</td>\n",
       "      <td>0.164</td>\n",
       "      <td>0.9019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSr2jQPjy59</td>\n",
       "      <td>1629224075</td>\n",
       "      <td>44425.76013</td>\n",
       "      <td>44425.76013</td>\n",
       "      <td>...</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0.942</td>\n",
       "      <td>0.058</td>\n",
       "      <td>0.5574</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSpWzdxJIIV</td>\n",
       "      <td>1629140321</td>\n",
       "      <td>44424.79075</td>\n",
       "      <td>44424.79075</td>\n",
       "      <td>...</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.041</td>\n",
       "      <td>0.776</td>\n",
       "      <td>0.184</td>\n",
       "      <td>0.8178</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSkdxyJAk2n</td>\n",
       "      <td>1628976206</td>\n",
       "      <td>44422.89127</td>\n",
       "      <td>44422.89127</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0.846</td>\n",
       "      <td>0.154</td>\n",
       "      <td>0.7964</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>shmee150</td>\n",
       "      <td>1581500</td>\n",
       "      <td>2857</td>\n",
       "      <td>10552</td>\n",
       "      <td>CSfHSEzi3BD</td>\n",
       "      <td>1628796639</td>\n",
       "      <td>44420.81295</td>\n",
       "      <td>44420.81295</td>\n",
       "      <td>...</td>\n",
       "      <td>CarWeek</td>\n",
       "      <td>Shmee150</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0.982</td>\n",
       "      <td>0.018</td>\n",
       "      <td>0.0644</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>343</th>\n",
       "      <td>343</td>\n",
       "      <td>343</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSZ8acRJ4jt</td>\n",
       "      <td>1628623169</td>\n",
       "      <td>44418.80520</td>\n",
       "      <td>44418.80520</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0.783</td>\n",
       "      <td>0.217</td>\n",
       "      <td>0.7925</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>344</th>\n",
       "      <td>344</td>\n",
       "      <td>344</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSZZfp2Hs0r</td>\n",
       "      <td>1628604861</td>\n",
       "      <td>44418.59330</td>\n",
       "      <td>44418.59330</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0.708</td>\n",
       "      <td>0.292</td>\n",
       "      <td>0.9439</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>345</th>\n",
       "      <td>345</td>\n",
       "      <td>345</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSYTSCEgCC7</td>\n",
       "      <td>1628568165</td>\n",
       "      <td>44418.16858</td>\n",
       "      <td>44418.16858</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.056</td>\n",
       "      <td>0.7</td>\n",
       "      <td>0.243</td>\n",
       "      <td>0.9625</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>346</th>\n",
       "      <td>346</td>\n",
       "      <td>346</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSW4jvynJ3N</td>\n",
       "      <td>1628520524</td>\n",
       "      <td>44417.61718</td>\n",
       "      <td>44417.61718</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0.785</td>\n",
       "      <td>0.215</td>\n",
       "      <td>0.8816</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>347</th>\n",
       "      <td>347</td>\n",
       "      <td>347</td>\n",
       "      <td>simeonpanda</td>\n",
       "      <td>7872317</td>\n",
       "      <td>187</td>\n",
       "      <td>7465</td>\n",
       "      <td>CSWB2CUrFo2</td>\n",
       "      <td>1628491798</td>\n",
       "      <td>44417.28470</td>\n",
       "      <td>44417.28470</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0.733</td>\n",
       "      <td>0.267</td>\n",
       "      <td>0.873</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>348 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     index  ï»¿       author  total_followers  total_following  number_posts  \\\n",
       "0        0    0     shmee150          1581500             2857         10552   \n",
       "1        1    1     shmee150          1581500             2857         10552   \n",
       "2        2    2     shmee150          1581500             2857         10552   \n",
       "3        3    3     shmee150          1581500             2857         10552   \n",
       "4        4    4     shmee150          1581500             2857         10552   \n",
       "..     ...  ...          ...              ...              ...           ...   \n",
       "343    343  343  simeonpanda          7872317              187          7465   \n",
       "344    344  344  simeonpanda          7872317              187          7465   \n",
       "345    345  345  simeonpanda          7872317              187          7465   \n",
       "346    346  346  simeonpanda          7872317              187          7465   \n",
       "347    347  347  simeonpanda          7872317              187          7465   \n",
       "\n",
       "       shortcode   timestamp         Date         time  ...     Tag_6  \\\n",
       "0    CSzoxcyrzj2  1629485286  44428.78340  44428.78340  ...   LAcars    \n",
       "1    CSr2jQPjy59  1629224075  44425.76013  44425.76013  ...  Shmee150   \n",
       "2    CSpWzdxJIIV  1629140321  44424.79075  44424.79075  ...  Shmee150   \n",
       "3    CSkdxyJAk2n  1628976206  44422.89127  44422.89127  ...       NaN   \n",
       "4    CSfHSEzi3BD  1628796639  44420.81295  44420.81295  ...  CarWeek    \n",
       "..           ...         ...          ...          ...  ...       ...   \n",
       "343  CSZ8acRJ4jt  1628623169  44418.80520  44418.80520  ...       NaN   \n",
       "344  CSZZfp2Hs0r  1628604861  44418.59330  44418.59330  ...       NaN   \n",
       "345  CSYTSCEgCC7  1628568165  44418.16858  44418.16858  ...       NaN   \n",
       "346  CSW4jvynJ3N  1628520524  44417.61718  44417.61718  ...       NaN   \n",
       "347  CSWB2CUrFo2  1628491798  44417.28470  44417.28470  ...       NaN   \n",
       "\n",
       "        Tag_7  Tag_8  Tag_9 Tag_10 Tag_11    neg    neu    pos compound  \n",
       "0    Shmee150    NaN    NaN    NaN    NaN  0.054  0.782  0.164   0.9019  \n",
       "1         NaN    NaN    NaN    NaN    NaN      0  0.942  0.058   0.5574  \n",
       "2         NaN    NaN    NaN    NaN    NaN  0.041  0.776  0.184   0.8178  \n",
       "3         NaN    NaN    NaN    NaN    NaN      0  0.846  0.154   0.7964  \n",
       "4    Shmee150    NaN    NaN    NaN    NaN      0  0.982  0.018   0.0644  \n",
       "..        ...    ...    ...    ...    ...    ...    ...    ...      ...  \n",
       "343       NaN    NaN    NaN    NaN    NaN      0  0.783  0.217   0.7925  \n",
       "344       NaN    NaN    NaN    NaN    NaN      0  0.708  0.292   0.9439  \n",
       "345       NaN    NaN    NaN    NaN    NaN  0.056    0.7  0.243   0.9625  \n",
       "346       NaN    NaN    NaN    NaN    NaN      0  0.785  0.215   0.8816  \n",
       "347       NaN    NaN    NaN    NaN    NaN      0  0.733  0.267    0.873  \n",
       "\n",
       "[348 rows x 31 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "pleased-preparation",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv(\"../../resources/sentiment_full_data_08.27.21.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "broken-supervision",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:PythonData] *",
   "language": "python",
   "name": "conda-env-PythonData-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
